// <auto-generated />
// Built from: hl7.fhir.r4.core version: 4.0.1

using System;
using System.Buffers;
using System.Collections.Generic;
using System.IO;
using System.Text;
using System.Text.Json;
using System.Text.Json.Serialization;
using Fhir.R4.Models;

namespace Fhir.R4.Serialization
{
  /// <summary>
  /// Common resource converter to support polymorphic deserialization.
  /// </summary>
  public class JsonStreamResourceConverter : JsonConverter<Resource>
  {
    private static readonly byte[] _startObject = Encoding.UTF8.GetBytes("{");
    private static readonly byte[] _endObject = Encoding.UTF8.GetBytes("}");
    private static readonly byte[] _startArray = Encoding.UTF8.GetBytes("[");
    private static readonly byte[] _endArray = Encoding.UTF8.GetBytes("]");
    private static readonly byte[] _comma = Encoding.UTF8.GetBytes(",");
    private static readonly byte[] _propertySep = Encoding.UTF8.GetBytes(":");
    private static readonly byte[] _quote = Encoding.UTF8.GetBytes("\"");

    /// <summary>
    /// Determines whether the specified type can be converted.
    /// </summary>
    public override bool CanConvert(Type objectType) =>
      typeof(Resource).IsAssignableFrom(objectType);

    /// <summary>
    /// Writes a specified value as JSON.
    /// </summary>
    public override void Write(Utf8JsonWriter writer, Resource resource, JsonSerializerOptions options)
    {
      switch (resource)
      {
        case Account typedAccount:
          typedAccount.SerializeJson(writer, options, true);
          break;
        case ActivityDefinition typedActivityDefinition:
          typedActivityDefinition.SerializeJson(writer, options, true);
          break;
        case AdverseEvent typedAdverseEvent:
          typedAdverseEvent.SerializeJson(writer, options, true);
          break;
        case AllergyIntolerance typedAllergyIntolerance:
          typedAllergyIntolerance.SerializeJson(writer, options, true);
          break;
        case Appointment typedAppointment:
          typedAppointment.SerializeJson(writer, options, true);
          break;
        case AppointmentResponse typedAppointmentResponse:
          typedAppointmentResponse.SerializeJson(writer, options, true);
          break;
        case AuditEvent typedAuditEvent:
          typedAuditEvent.SerializeJson(writer, options, true);
          break;
        case Basic typedBasic:
          typedBasic.SerializeJson(writer, options, true);
          break;
        case Binary typedBinary:
          typedBinary.SerializeJson(writer, options, true);
          break;
        case BiologicallyDerivedProduct typedBiologicallyDerivedProduct:
          typedBiologicallyDerivedProduct.SerializeJson(writer, options, true);
          break;
        case BodyStructure typedBodyStructure:
          typedBodyStructure.SerializeJson(writer, options, true);
          break;
        case Bundle typedBundle:
          typedBundle.SerializeJson(writer, options, true);
          break;
        case CapabilityStatement typedCapabilityStatement:
          typedCapabilityStatement.SerializeJson(writer, options, true);
          break;
        case CarePlan typedCarePlan:
          typedCarePlan.SerializeJson(writer, options, true);
          break;
        case CareTeam typedCareTeam:
          typedCareTeam.SerializeJson(writer, options, true);
          break;
        case CatalogEntry typedCatalogEntry:
          typedCatalogEntry.SerializeJson(writer, options, true);
          break;
        case ChargeItem typedChargeItem:
          typedChargeItem.SerializeJson(writer, options, true);
          break;
        case ChargeItemDefinition typedChargeItemDefinition:
          typedChargeItemDefinition.SerializeJson(writer, options, true);
          break;
        case Claim typedClaim:
          typedClaim.SerializeJson(writer, options, true);
          break;
        case ClaimResponse typedClaimResponse:
          typedClaimResponse.SerializeJson(writer, options, true);
          break;
        case ClinicalImpression typedClinicalImpression:
          typedClinicalImpression.SerializeJson(writer, options, true);
          break;
        case CodeSystem typedCodeSystem:
          typedCodeSystem.SerializeJson(writer, options, true);
          break;
        case Communication typedCommunication:
          typedCommunication.SerializeJson(writer, options, true);
          break;
        case CommunicationRequest typedCommunicationRequest:
          typedCommunicationRequest.SerializeJson(writer, options, true);
          break;
        case CompartmentDefinition typedCompartmentDefinition:
          typedCompartmentDefinition.SerializeJson(writer, options, true);
          break;
        case Composition typedComposition:
          typedComposition.SerializeJson(writer, options, true);
          break;
        case ConceptMap typedConceptMap:
          typedConceptMap.SerializeJson(writer, options, true);
          break;
        case Condition typedCondition:
          typedCondition.SerializeJson(writer, options, true);
          break;
        case Consent typedConsent:
          typedConsent.SerializeJson(writer, options, true);
          break;
        case Contract typedContract:
          typedContract.SerializeJson(writer, options, true);
          break;
        case Coverage typedCoverage:
          typedCoverage.SerializeJson(writer, options, true);
          break;
        case CoverageEligibilityRequest typedCoverageEligibilityRequest:
          typedCoverageEligibilityRequest.SerializeJson(writer, options, true);
          break;
        case CoverageEligibilityResponse typedCoverageEligibilityResponse:
          typedCoverageEligibilityResponse.SerializeJson(writer, options, true);
          break;
        case DetectedIssue typedDetectedIssue:
          typedDetectedIssue.SerializeJson(writer, options, true);
          break;
        case Device typedDevice:
          typedDevice.SerializeJson(writer, options, true);
          break;
        case DeviceDefinition typedDeviceDefinition:
          typedDeviceDefinition.SerializeJson(writer, options, true);
          break;
        case DeviceMetric typedDeviceMetric:
          typedDeviceMetric.SerializeJson(writer, options, true);
          break;
        case DeviceRequest typedDeviceRequest:
          typedDeviceRequest.SerializeJson(writer, options, true);
          break;
        case DeviceUseStatement typedDeviceUseStatement:
          typedDeviceUseStatement.SerializeJson(writer, options, true);
          break;
        case DiagnosticReport typedDiagnosticReport:
          typedDiagnosticReport.SerializeJson(writer, options, true);
          break;
        case DocumentManifest typedDocumentManifest:
          typedDocumentManifest.SerializeJson(writer, options, true);
          break;
        case DocumentReference typedDocumentReference:
          typedDocumentReference.SerializeJson(writer, options, true);
          break;
        case EffectEvidenceSynthesis typedEffectEvidenceSynthesis:
          typedEffectEvidenceSynthesis.SerializeJson(writer, options, true);
          break;
        case Encounter typedEncounter:
          typedEncounter.SerializeJson(writer, options, true);
          break;
        case Endpoint typedEndpoint:
          typedEndpoint.SerializeJson(writer, options, true);
          break;
        case EnrollmentRequest typedEnrollmentRequest:
          typedEnrollmentRequest.SerializeJson(writer, options, true);
          break;
        case EnrollmentResponse typedEnrollmentResponse:
          typedEnrollmentResponse.SerializeJson(writer, options, true);
          break;
        case EpisodeOfCare typedEpisodeOfCare:
          typedEpisodeOfCare.SerializeJson(writer, options, true);
          break;
        case EventDefinition typedEventDefinition:
          typedEventDefinition.SerializeJson(writer, options, true);
          break;
        case Evidence typedEvidence:
          typedEvidence.SerializeJson(writer, options, true);
          break;
        case EvidenceVariable typedEvidenceVariable:
          typedEvidenceVariable.SerializeJson(writer, options, true);
          break;
        case ExampleScenario typedExampleScenario:
          typedExampleScenario.SerializeJson(writer, options, true);
          break;
        case ExplanationOfBenefit typedExplanationOfBenefit:
          typedExplanationOfBenefit.SerializeJson(writer, options, true);
          break;
        case FamilyMemberHistory typedFamilyMemberHistory:
          typedFamilyMemberHistory.SerializeJson(writer, options, true);
          break;
        case Flag typedFlag:
          typedFlag.SerializeJson(writer, options, true);
          break;
        case Goal typedGoal:
          typedGoal.SerializeJson(writer, options, true);
          break;
        case GraphDefinition typedGraphDefinition:
          typedGraphDefinition.SerializeJson(writer, options, true);
          break;
        case Group typedGroup:
          typedGroup.SerializeJson(writer, options, true);
          break;
        case GuidanceResponse typedGuidanceResponse:
          typedGuidanceResponse.SerializeJson(writer, options, true);
          break;
        case HealthcareService typedHealthcareService:
          typedHealthcareService.SerializeJson(writer, options, true);
          break;
        case ImagingStudy typedImagingStudy:
          typedImagingStudy.SerializeJson(writer, options, true);
          break;
        case Immunization typedImmunization:
          typedImmunization.SerializeJson(writer, options, true);
          break;
        case ImmunizationEvaluation typedImmunizationEvaluation:
          typedImmunizationEvaluation.SerializeJson(writer, options, true);
          break;
        case ImmunizationRecommendation typedImmunizationRecommendation:
          typedImmunizationRecommendation.SerializeJson(writer, options, true);
          break;
        case ImplementationGuide typedImplementationGuide:
          typedImplementationGuide.SerializeJson(writer, options, true);
          break;
        case InsurancePlan typedInsurancePlan:
          typedInsurancePlan.SerializeJson(writer, options, true);
          break;
        case Invoice typedInvoice:
          typedInvoice.SerializeJson(writer, options, true);
          break;
        case Library typedLibrary:
          typedLibrary.SerializeJson(writer, options, true);
          break;
        case Linkage typedLinkage:
          typedLinkage.SerializeJson(writer, options, true);
          break;
        case List typedList:
          typedList.SerializeJson(writer, options, true);
          break;
        case Location typedLocation:
          typedLocation.SerializeJson(writer, options, true);
          break;
        case Measure typedMeasure:
          typedMeasure.SerializeJson(writer, options, true);
          break;
        case MeasureReport typedMeasureReport:
          typedMeasureReport.SerializeJson(writer, options, true);
          break;
        case Media typedMedia:
          typedMedia.SerializeJson(writer, options, true);
          break;
        case Medication typedMedication:
          typedMedication.SerializeJson(writer, options, true);
          break;
        case MedicationAdministration typedMedicationAdministration:
          typedMedicationAdministration.SerializeJson(writer, options, true);
          break;
        case MedicationDispense typedMedicationDispense:
          typedMedicationDispense.SerializeJson(writer, options, true);
          break;
        case MedicationKnowledge typedMedicationKnowledge:
          typedMedicationKnowledge.SerializeJson(writer, options, true);
          break;
        case MedicationRequest typedMedicationRequest:
          typedMedicationRequest.SerializeJson(writer, options, true);
          break;
        case MedicationStatement typedMedicationStatement:
          typedMedicationStatement.SerializeJson(writer, options, true);
          break;
        case MedicinalProduct typedMedicinalProduct:
          typedMedicinalProduct.SerializeJson(writer, options, true);
          break;
        case MedicinalProductAuthorization typedMedicinalProductAuthorization:
          typedMedicinalProductAuthorization.SerializeJson(writer, options, true);
          break;
        case MedicinalProductContraindication typedMedicinalProductContraindication:
          typedMedicinalProductContraindication.SerializeJson(writer, options, true);
          break;
        case MedicinalProductIndication typedMedicinalProductIndication:
          typedMedicinalProductIndication.SerializeJson(writer, options, true);
          break;
        case MedicinalProductIngredient typedMedicinalProductIngredient:
          typedMedicinalProductIngredient.SerializeJson(writer, options, true);
          break;
        case MedicinalProductInteraction typedMedicinalProductInteraction:
          typedMedicinalProductInteraction.SerializeJson(writer, options, true);
          break;
        case MedicinalProductManufactured typedMedicinalProductManufactured:
          typedMedicinalProductManufactured.SerializeJson(writer, options, true);
          break;
        case MedicinalProductPackaged typedMedicinalProductPackaged:
          typedMedicinalProductPackaged.SerializeJson(writer, options, true);
          break;
        case MedicinalProductPharmaceutical typedMedicinalProductPharmaceutical:
          typedMedicinalProductPharmaceutical.SerializeJson(writer, options, true);
          break;
        case MedicinalProductUndesirableEffect typedMedicinalProductUndesirableEffect:
          typedMedicinalProductUndesirableEffect.SerializeJson(writer, options, true);
          break;
        case MessageDefinition typedMessageDefinition:
          typedMessageDefinition.SerializeJson(writer, options, true);
          break;
        case MessageHeader typedMessageHeader:
          typedMessageHeader.SerializeJson(writer, options, true);
          break;
        case MolecularSequence typedMolecularSequence:
          typedMolecularSequence.SerializeJson(writer, options, true);
          break;
        case NamingSystem typedNamingSystem:
          typedNamingSystem.SerializeJson(writer, options, true);
          break;
        case NutritionOrder typedNutritionOrder:
          typedNutritionOrder.SerializeJson(writer, options, true);
          break;
        case Observation typedObservation:
          typedObservation.SerializeJson(writer, options, true);
          break;
        case ObservationDefinition typedObservationDefinition:
          typedObservationDefinition.SerializeJson(writer, options, true);
          break;
        case OperationDefinition typedOperationDefinition:
          typedOperationDefinition.SerializeJson(writer, options, true);
          break;
        case OperationOutcome typedOperationOutcome:
          typedOperationOutcome.SerializeJson(writer, options, true);
          break;
        case Organization typedOrganization:
          typedOrganization.SerializeJson(writer, options, true);
          break;
        case OrganizationAffiliation typedOrganizationAffiliation:
          typedOrganizationAffiliation.SerializeJson(writer, options, true);
          break;
        case Parameters typedParameters:
          typedParameters.SerializeJson(writer, options, true);
          break;
        case Patient typedPatient:
          typedPatient.SerializeJson(writer, options, true);
          break;
        case PaymentNotice typedPaymentNotice:
          typedPaymentNotice.SerializeJson(writer, options, true);
          break;
        case PaymentReconciliation typedPaymentReconciliation:
          typedPaymentReconciliation.SerializeJson(writer, options, true);
          break;
        case Person typedPerson:
          typedPerson.SerializeJson(writer, options, true);
          break;
        case PlanDefinition typedPlanDefinition:
          typedPlanDefinition.SerializeJson(writer, options, true);
          break;
        case Practitioner typedPractitioner:
          typedPractitioner.SerializeJson(writer, options, true);
          break;
        case PractitionerRole typedPractitionerRole:
          typedPractitionerRole.SerializeJson(writer, options, true);
          break;
        case Procedure typedProcedure:
          typedProcedure.SerializeJson(writer, options, true);
          break;
        case Provenance typedProvenance:
          typedProvenance.SerializeJson(writer, options, true);
          break;
        case Questionnaire typedQuestionnaire:
          typedQuestionnaire.SerializeJson(writer, options, true);
          break;
        case QuestionnaireResponse typedQuestionnaireResponse:
          typedQuestionnaireResponse.SerializeJson(writer, options, true);
          break;
        case RelatedPerson typedRelatedPerson:
          typedRelatedPerson.SerializeJson(writer, options, true);
          break;
        case RequestGroup typedRequestGroup:
          typedRequestGroup.SerializeJson(writer, options, true);
          break;
        case ResearchDefinition typedResearchDefinition:
          typedResearchDefinition.SerializeJson(writer, options, true);
          break;
        case ResearchElementDefinition typedResearchElementDefinition:
          typedResearchElementDefinition.SerializeJson(writer, options, true);
          break;
        case ResearchStudy typedResearchStudy:
          typedResearchStudy.SerializeJson(writer, options, true);
          break;
        case ResearchSubject typedResearchSubject:
          typedResearchSubject.SerializeJson(writer, options, true);
          break;
        case RiskAssessment typedRiskAssessment:
          typedRiskAssessment.SerializeJson(writer, options, true);
          break;
        case RiskEvidenceSynthesis typedRiskEvidenceSynthesis:
          typedRiskEvidenceSynthesis.SerializeJson(writer, options, true);
          break;
        case Schedule typedSchedule:
          typedSchedule.SerializeJson(writer, options, true);
          break;
        case SearchParameter typedSearchParameter:
          typedSearchParameter.SerializeJson(writer, options, true);
          break;
        case ServiceRequest typedServiceRequest:
          typedServiceRequest.SerializeJson(writer, options, true);
          break;
        case Slot typedSlot:
          typedSlot.SerializeJson(writer, options, true);
          break;
        case Specimen typedSpecimen:
          typedSpecimen.SerializeJson(writer, options, true);
          break;
        case SpecimenDefinition typedSpecimenDefinition:
          typedSpecimenDefinition.SerializeJson(writer, options, true);
          break;
        case StructureDefinition typedStructureDefinition:
          typedStructureDefinition.SerializeJson(writer, options, true);
          break;
        case StructureMap typedStructureMap:
          typedStructureMap.SerializeJson(writer, options, true);
          break;
        case Subscription typedSubscription:
          typedSubscription.SerializeJson(writer, options, true);
          break;
        case Substance typedSubstance:
          typedSubstance.SerializeJson(writer, options, true);
          break;
        case SubstanceNucleicAcid typedSubstanceNucleicAcid:
          typedSubstanceNucleicAcid.SerializeJson(writer, options, true);
          break;
        case SubstancePolymer typedSubstancePolymer:
          typedSubstancePolymer.SerializeJson(writer, options, true);
          break;
        case SubstanceProtein typedSubstanceProtein:
          typedSubstanceProtein.SerializeJson(writer, options, true);
          break;
        case SubstanceReferenceInformation typedSubstanceReferenceInformation:
          typedSubstanceReferenceInformation.SerializeJson(writer, options, true);
          break;
        case SubstanceSourceMaterial typedSubstanceSourceMaterial:
          typedSubstanceSourceMaterial.SerializeJson(writer, options, true);
          break;
        case SubstanceSpecification typedSubstanceSpecification:
          typedSubstanceSpecification.SerializeJson(writer, options, true);
          break;
        case SupplyDelivery typedSupplyDelivery:
          typedSupplyDelivery.SerializeJson(writer, options, true);
          break;
        case SupplyRequest typedSupplyRequest:
          typedSupplyRequest.SerializeJson(writer, options, true);
          break;
        case Task typedTask:
          typedTask.SerializeJson(writer, options, true);
          break;
        case TerminologyCapabilities typedTerminologyCapabilities:
          typedTerminologyCapabilities.SerializeJson(writer, options, true);
          break;
        case TestReport typedTestReport:
          typedTestReport.SerializeJson(writer, options, true);
          break;
        case TestScript typedTestScript:
          typedTestScript.SerializeJson(writer, options, true);
          break;
        case ValueSet typedValueSet:
          typedValueSet.SerializeJson(writer, options, true);
          break;
        case VerificationResult typedVerificationResult:
          typedVerificationResult.SerializeJson(writer, options, true);
          break;
        case VisionPrescription typedVisionPrescription:
          typedVisionPrescription.SerializeJson(writer, options, true);
          break;
      }

      writer.Flush();
    }

    /// <summary>
    /// Reads and converts the JSON to a typed object.
    /// </summary>
    public override Resource Read(ref Utf8JsonReader reader, Type typeToConvert, JsonSerializerOptions options)
    {
      return PolymorphicRead(ref reader, typeToConvert, options);
    }

    /// <summary>
    /// Copy raw data from a Utf8JsonReader to a MemoryStream.
    /// </summary>
    private static void WriteReaderValueBytes(ref MemoryStream ms, ref Utf8JsonReader reader)
    {
      if (reader.HasValueSequence)
      {
        byte[] data = new byte[reader.ValueSequence.Length];
        reader.ValueSequence.CopyTo(data);
        ms.Write(data);
        return;
      }

      ms.Write(reader.ValueSpan);
    }

    /// <summary>
    /// Add a JSON seperator token, if necessary.
    /// </summary>
    private static void AddSeperatorIfNeeded(ref MemoryStream ms, ref Utf8JsonReader reader, JsonTokenType last)
    {
      switch (last)
      {
        case JsonTokenType.StartObject:
        case JsonTokenType.StartArray:
          // do nothing
          break;
        case JsonTokenType.PropertyName:
          ms.Write(_propertySep);
          break;
        default:
          ms.Write(_comma);
          break;
      }
    }

    /// <summary>
    /// Read override to handle polymorphic reading of resources.
    /// </summary>
    public static Resource PolymorphicRead(ref Utf8JsonReader reader, Type typeToConvert, JsonSerializerOptions options)
    {
      string propertyName = null;
      string resourceType = null;

      if (reader.TokenType != JsonTokenType.StartObject)
      {
        throw new JsonException();
      }

      reader.Read();
      if (reader.TokenType != JsonTokenType.PropertyName)
      {
        throw new JsonException();
      }

      propertyName = reader.GetString();
      if (propertyName == "resourceType")
      {
        reader.Read();
        if (reader.TokenType != JsonTokenType.String)
        {
          throw new JsonException();
        }

        resourceType = reader.GetString();

        return DoPolymorphicRead(ref reader, options, resourceType);
      }

      MemoryStream ms = new MemoryStream(4096);

      ms.Write(Encoding.UTF8.GetBytes($"{{\"{propertyName}\""));
      propertyName = string.Empty;

      int depth = reader.CurrentDepth;
      bool done = false;
      bool nextValueIsResourceType = false;
      JsonTokenType lastToken = JsonTokenType.PropertyName;

      while ((!done) && reader.Read())
      {
        switch (reader.TokenType)
        {
          case JsonTokenType.StartObject:
            AddSeperatorIfNeeded(ref ms, ref reader, lastToken);
            ms.Write(_startObject);
            break;

          case JsonTokenType.EndObject:
            ms.Write(_endObject);
            if (reader.CurrentDepth == (depth - 1))
            {
              done = true;
            }
            break;

          case JsonTokenType.StartArray:
            AddSeperatorIfNeeded(ref ms, ref reader, lastToken);
            ms.Write(_startArray);
            break;

          case JsonTokenType.EndArray:
            ms.Write(_endArray);
            break;

          case JsonTokenType.PropertyName:
            AddSeperatorIfNeeded(ref ms, ref reader, lastToken);
            if (reader.CurrentDepth == depth)
            {
              if (reader.ValueTextEquals("resourceType"))
              {
                nextValueIsResourceType = true;
              }
            }

            ms.Write(_quote);
            WriteReaderValueBytes(ref ms, ref reader);
            ms.Write(_quote);
            break;

          case JsonTokenType.Comment:
            break;

          case JsonTokenType.String:
            AddSeperatorIfNeeded(ref ms, ref reader, lastToken);
            if (nextValueIsResourceType)
            {
              resourceType = reader.GetString();
              nextValueIsResourceType = false;
            }

            ms.Write(_quote);
            WriteReaderValueBytes(ref ms, ref reader);
            ms.Write(_quote);
            break;

          case JsonTokenType.Number:
          case JsonTokenType.True:
          case JsonTokenType.False:
          case JsonTokenType.Null:
          default:
            AddSeperatorIfNeeded(ref ms, ref reader, lastToken);
            WriteReaderValueBytes(ref ms, ref reader);
            break;
        }

        lastToken = reader.TokenType;
      }

      ms.Flush();
      Utf8JsonReader secondary = new Utf8JsonReader(ms.GetBuffer());

      return DoPolymorphicRead(ref secondary, options, resourceType);
    }
    /// <summary>
    /// Sub-function for simpler handling of reader switching.
    /// </summary>
    public static Resource DoPolymorphicRead(ref Utf8JsonReader reader, JsonSerializerOptions options, string resourceType)
    {
      IFhirJsonSerializable target = null;
      switch (resourceType)
      {
        case "Account":
          target = new Fhir.R4.Models.Account();
          target.DeserializeJson(ref reader, options);
          break;
        case "ActivityDefinition":
          target = new Fhir.R4.Models.ActivityDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "AdverseEvent":
          target = new Fhir.R4.Models.AdverseEvent();
          target.DeserializeJson(ref reader, options);
          break;
        case "AllergyIntolerance":
          target = new Fhir.R4.Models.AllergyIntolerance();
          target.DeserializeJson(ref reader, options);
          break;
        case "Appointment":
          target = new Fhir.R4.Models.Appointment();
          target.DeserializeJson(ref reader, options);
          break;
        case "AppointmentResponse":
          target = new Fhir.R4.Models.AppointmentResponse();
          target.DeserializeJson(ref reader, options);
          break;
        case "AuditEvent":
          target = new Fhir.R4.Models.AuditEvent();
          target.DeserializeJson(ref reader, options);
          break;
        case "Basic":
          target = new Fhir.R4.Models.Basic();
          target.DeserializeJson(ref reader, options);
          break;
        case "Binary":
          target = new Fhir.R4.Models.Binary();
          target.DeserializeJson(ref reader, options);
          break;
        case "BiologicallyDerivedProduct":
          target = new Fhir.R4.Models.BiologicallyDerivedProduct();
          target.DeserializeJson(ref reader, options);
          break;
        case "BodyStructure":
          target = new Fhir.R4.Models.BodyStructure();
          target.DeserializeJson(ref reader, options);
          break;
        case "Bundle":
          target = new Fhir.R4.Models.Bundle();
          target.DeserializeJson(ref reader, options);
          break;
        case "CapabilityStatement":
          target = new Fhir.R4.Models.CapabilityStatement();
          target.DeserializeJson(ref reader, options);
          break;
        case "CarePlan":
          target = new Fhir.R4.Models.CarePlan();
          target.DeserializeJson(ref reader, options);
          break;
        case "CareTeam":
          target = new Fhir.R4.Models.CareTeam();
          target.DeserializeJson(ref reader, options);
          break;
        case "CatalogEntry":
          target = new Fhir.R4.Models.CatalogEntry();
          target.DeserializeJson(ref reader, options);
          break;
        case "ChargeItem":
          target = new Fhir.R4.Models.ChargeItem();
          target.DeserializeJson(ref reader, options);
          break;
        case "ChargeItemDefinition":
          target = new Fhir.R4.Models.ChargeItemDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "Claim":
          target = new Fhir.R4.Models.Claim();
          target.DeserializeJson(ref reader, options);
          break;
        case "ClaimResponse":
          target = new Fhir.R4.Models.ClaimResponse();
          target.DeserializeJson(ref reader, options);
          break;
        case "ClinicalImpression":
          target = new Fhir.R4.Models.ClinicalImpression();
          target.DeserializeJson(ref reader, options);
          break;
        case "CodeSystem":
          target = new Fhir.R4.Models.CodeSystem();
          target.DeserializeJson(ref reader, options);
          break;
        case "Communication":
          target = new Fhir.R4.Models.Communication();
          target.DeserializeJson(ref reader, options);
          break;
        case "CommunicationRequest":
          target = new Fhir.R4.Models.CommunicationRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "CompartmentDefinition":
          target = new Fhir.R4.Models.CompartmentDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "Composition":
          target = new Fhir.R4.Models.Composition();
          target.DeserializeJson(ref reader, options);
          break;
        case "ConceptMap":
          target = new Fhir.R4.Models.ConceptMap();
          target.DeserializeJson(ref reader, options);
          break;
        case "Condition":
          target = new Fhir.R4.Models.Condition();
          target.DeserializeJson(ref reader, options);
          break;
        case "Consent":
          target = new Fhir.R4.Models.Consent();
          target.DeserializeJson(ref reader, options);
          break;
        case "Contract":
          target = new Fhir.R4.Models.Contract();
          target.DeserializeJson(ref reader, options);
          break;
        case "Coverage":
          target = new Fhir.R4.Models.Coverage();
          target.DeserializeJson(ref reader, options);
          break;
        case "CoverageEligibilityRequest":
          target = new Fhir.R4.Models.CoverageEligibilityRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "CoverageEligibilityResponse":
          target = new Fhir.R4.Models.CoverageEligibilityResponse();
          target.DeserializeJson(ref reader, options);
          break;
        case "DetectedIssue":
          target = new Fhir.R4.Models.DetectedIssue();
          target.DeserializeJson(ref reader, options);
          break;
        case "Device":
          target = new Fhir.R4.Models.Device();
          target.DeserializeJson(ref reader, options);
          break;
        case "DeviceDefinition":
          target = new Fhir.R4.Models.DeviceDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "DeviceMetric":
          target = new Fhir.R4.Models.DeviceMetric();
          target.DeserializeJson(ref reader, options);
          break;
        case "DeviceRequest":
          target = new Fhir.R4.Models.DeviceRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "DeviceUseStatement":
          target = new Fhir.R4.Models.DeviceUseStatement();
          target.DeserializeJson(ref reader, options);
          break;
        case "DiagnosticReport":
          target = new Fhir.R4.Models.DiagnosticReport();
          target.DeserializeJson(ref reader, options);
          break;
        case "DocumentManifest":
          target = new Fhir.R4.Models.DocumentManifest();
          target.DeserializeJson(ref reader, options);
          break;
        case "DocumentReference":
          target = new Fhir.R4.Models.DocumentReference();
          target.DeserializeJson(ref reader, options);
          break;
        case "EffectEvidenceSynthesis":
          target = new Fhir.R4.Models.EffectEvidenceSynthesis();
          target.DeserializeJson(ref reader, options);
          break;
        case "Encounter":
          target = new Fhir.R4.Models.Encounter();
          target.DeserializeJson(ref reader, options);
          break;
        case "Endpoint":
          target = new Fhir.R4.Models.Endpoint();
          target.DeserializeJson(ref reader, options);
          break;
        case "EnrollmentRequest":
          target = new Fhir.R4.Models.EnrollmentRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "EnrollmentResponse":
          target = new Fhir.R4.Models.EnrollmentResponse();
          target.DeserializeJson(ref reader, options);
          break;
        case "EpisodeOfCare":
          target = new Fhir.R4.Models.EpisodeOfCare();
          target.DeserializeJson(ref reader, options);
          break;
        case "EventDefinition":
          target = new Fhir.R4.Models.EventDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "Evidence":
          target = new Fhir.R4.Models.Evidence();
          target.DeserializeJson(ref reader, options);
          break;
        case "EvidenceVariable":
          target = new Fhir.R4.Models.EvidenceVariable();
          target.DeserializeJson(ref reader, options);
          break;
        case "ExampleScenario":
          target = new Fhir.R4.Models.ExampleScenario();
          target.DeserializeJson(ref reader, options);
          break;
        case "ExplanationOfBenefit":
          target = new Fhir.R4.Models.ExplanationOfBenefit();
          target.DeserializeJson(ref reader, options);
          break;
        case "FamilyMemberHistory":
          target = new Fhir.R4.Models.FamilyMemberHistory();
          target.DeserializeJson(ref reader, options);
          break;
        case "Flag":
          target = new Fhir.R4.Models.Flag();
          target.DeserializeJson(ref reader, options);
          break;
        case "Goal":
          target = new Fhir.R4.Models.Goal();
          target.DeserializeJson(ref reader, options);
          break;
        case "GraphDefinition":
          target = new Fhir.R4.Models.GraphDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "Group":
          target = new Fhir.R4.Models.Group();
          target.DeserializeJson(ref reader, options);
          break;
        case "GuidanceResponse":
          target = new Fhir.R4.Models.GuidanceResponse();
          target.DeserializeJson(ref reader, options);
          break;
        case "HealthcareService":
          target = new Fhir.R4.Models.HealthcareService();
          target.DeserializeJson(ref reader, options);
          break;
        case "ImagingStudy":
          target = new Fhir.R4.Models.ImagingStudy();
          target.DeserializeJson(ref reader, options);
          break;
        case "Immunization":
          target = new Fhir.R4.Models.Immunization();
          target.DeserializeJson(ref reader, options);
          break;
        case "ImmunizationEvaluation":
          target = new Fhir.R4.Models.ImmunizationEvaluation();
          target.DeserializeJson(ref reader, options);
          break;
        case "ImmunizationRecommendation":
          target = new Fhir.R4.Models.ImmunizationRecommendation();
          target.DeserializeJson(ref reader, options);
          break;
        case "ImplementationGuide":
          target = new Fhir.R4.Models.ImplementationGuide();
          target.DeserializeJson(ref reader, options);
          break;
        case "InsurancePlan":
          target = new Fhir.R4.Models.InsurancePlan();
          target.DeserializeJson(ref reader, options);
          break;
        case "Invoice":
          target = new Fhir.R4.Models.Invoice();
          target.DeserializeJson(ref reader, options);
          break;
        case "Library":
          target = new Fhir.R4.Models.Library();
          target.DeserializeJson(ref reader, options);
          break;
        case "Linkage":
          target = new Fhir.R4.Models.Linkage();
          target.DeserializeJson(ref reader, options);
          break;
        case "List":
          target = new Fhir.R4.Models.List();
          target.DeserializeJson(ref reader, options);
          break;
        case "Location":
          target = new Fhir.R4.Models.Location();
          target.DeserializeJson(ref reader, options);
          break;
        case "Measure":
          target = new Fhir.R4.Models.Measure();
          target.DeserializeJson(ref reader, options);
          break;
        case "MeasureReport":
          target = new Fhir.R4.Models.MeasureReport();
          target.DeserializeJson(ref reader, options);
          break;
        case "Media":
          target = new Fhir.R4.Models.Media();
          target.DeserializeJson(ref reader, options);
          break;
        case "Medication":
          target = new Fhir.R4.Models.Medication();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicationAdministration":
          target = new Fhir.R4.Models.MedicationAdministration();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicationDispense":
          target = new Fhir.R4.Models.MedicationDispense();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicationKnowledge":
          target = new Fhir.R4.Models.MedicationKnowledge();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicationRequest":
          target = new Fhir.R4.Models.MedicationRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicationStatement":
          target = new Fhir.R4.Models.MedicationStatement();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProduct":
          target = new Fhir.R4.Models.MedicinalProduct();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductAuthorization":
          target = new Fhir.R4.Models.MedicinalProductAuthorization();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductContraindication":
          target = new Fhir.R4.Models.MedicinalProductContraindication();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductIndication":
          target = new Fhir.R4.Models.MedicinalProductIndication();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductIngredient":
          target = new Fhir.R4.Models.MedicinalProductIngredient();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductInteraction":
          target = new Fhir.R4.Models.MedicinalProductInteraction();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductManufactured":
          target = new Fhir.R4.Models.MedicinalProductManufactured();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductPackaged":
          target = new Fhir.R4.Models.MedicinalProductPackaged();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductPharmaceutical":
          target = new Fhir.R4.Models.MedicinalProductPharmaceutical();
          target.DeserializeJson(ref reader, options);
          break;
        case "MedicinalProductUndesirableEffect":
          target = new Fhir.R4.Models.MedicinalProductUndesirableEffect();
          target.DeserializeJson(ref reader, options);
          break;
        case "MessageDefinition":
          target = new Fhir.R4.Models.MessageDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "MessageHeader":
          target = new Fhir.R4.Models.MessageHeader();
          target.DeserializeJson(ref reader, options);
          break;
        case "MolecularSequence":
          target = new Fhir.R4.Models.MolecularSequence();
          target.DeserializeJson(ref reader, options);
          break;
        case "NamingSystem":
          target = new Fhir.R4.Models.NamingSystem();
          target.DeserializeJson(ref reader, options);
          break;
        case "NutritionOrder":
          target = new Fhir.R4.Models.NutritionOrder();
          target.DeserializeJson(ref reader, options);
          break;
        case "Observation":
          target = new Fhir.R4.Models.Observation();
          target.DeserializeJson(ref reader, options);
          break;
        case "ObservationDefinition":
          target = new Fhir.R4.Models.ObservationDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "OperationDefinition":
          target = new Fhir.R4.Models.OperationDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "OperationOutcome":
          target = new Fhir.R4.Models.OperationOutcome();
          target.DeserializeJson(ref reader, options);
          break;
        case "Organization":
          target = new Fhir.R4.Models.Organization();
          target.DeserializeJson(ref reader, options);
          break;
        case "OrganizationAffiliation":
          target = new Fhir.R4.Models.OrganizationAffiliation();
          target.DeserializeJson(ref reader, options);
          break;
        case "Parameters":
          target = new Fhir.R4.Models.Parameters();
          target.DeserializeJson(ref reader, options);
          break;
        case "Patient":
          target = new Fhir.R4.Models.Patient();
          target.DeserializeJson(ref reader, options);
          break;
        case "PaymentNotice":
          target = new Fhir.R4.Models.PaymentNotice();
          target.DeserializeJson(ref reader, options);
          break;
        case "PaymentReconciliation":
          target = new Fhir.R4.Models.PaymentReconciliation();
          target.DeserializeJson(ref reader, options);
          break;
        case "Person":
          target = new Fhir.R4.Models.Person();
          target.DeserializeJson(ref reader, options);
          break;
        case "PlanDefinition":
          target = new Fhir.R4.Models.PlanDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "Practitioner":
          target = new Fhir.R4.Models.Practitioner();
          target.DeserializeJson(ref reader, options);
          break;
        case "PractitionerRole":
          target = new Fhir.R4.Models.PractitionerRole();
          target.DeserializeJson(ref reader, options);
          break;
        case "Procedure":
          target = new Fhir.R4.Models.Procedure();
          target.DeserializeJson(ref reader, options);
          break;
        case "Provenance":
          target = new Fhir.R4.Models.Provenance();
          target.DeserializeJson(ref reader, options);
          break;
        case "Questionnaire":
          target = new Fhir.R4.Models.Questionnaire();
          target.DeserializeJson(ref reader, options);
          break;
        case "QuestionnaireResponse":
          target = new Fhir.R4.Models.QuestionnaireResponse();
          target.DeserializeJson(ref reader, options);
          break;
        case "RelatedPerson":
          target = new Fhir.R4.Models.RelatedPerson();
          target.DeserializeJson(ref reader, options);
          break;
        case "RequestGroup":
          target = new Fhir.R4.Models.RequestGroup();
          target.DeserializeJson(ref reader, options);
          break;
        case "ResearchDefinition":
          target = new Fhir.R4.Models.ResearchDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "ResearchElementDefinition":
          target = new Fhir.R4.Models.ResearchElementDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "ResearchStudy":
          target = new Fhir.R4.Models.ResearchStudy();
          target.DeserializeJson(ref reader, options);
          break;
        case "ResearchSubject":
          target = new Fhir.R4.Models.ResearchSubject();
          target.DeserializeJson(ref reader, options);
          break;
        case "RiskAssessment":
          target = new Fhir.R4.Models.RiskAssessment();
          target.DeserializeJson(ref reader, options);
          break;
        case "RiskEvidenceSynthesis":
          target = new Fhir.R4.Models.RiskEvidenceSynthesis();
          target.DeserializeJson(ref reader, options);
          break;
        case "Schedule":
          target = new Fhir.R4.Models.Schedule();
          target.DeserializeJson(ref reader, options);
          break;
        case "SearchParameter":
          target = new Fhir.R4.Models.SearchParameter();
          target.DeserializeJson(ref reader, options);
          break;
        case "ServiceRequest":
          target = new Fhir.R4.Models.ServiceRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "Slot":
          target = new Fhir.R4.Models.Slot();
          target.DeserializeJson(ref reader, options);
          break;
        case "Specimen":
          target = new Fhir.R4.Models.Specimen();
          target.DeserializeJson(ref reader, options);
          break;
        case "SpecimenDefinition":
          target = new Fhir.R4.Models.SpecimenDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "StructureDefinition":
          target = new Fhir.R4.Models.StructureDefinition();
          target.DeserializeJson(ref reader, options);
          break;
        case "StructureMap":
          target = new Fhir.R4.Models.StructureMap();
          target.DeserializeJson(ref reader, options);
          break;
        case "Subscription":
          target = new Fhir.R4.Models.Subscription();
          target.DeserializeJson(ref reader, options);
          break;
        case "Substance":
          target = new Fhir.R4.Models.Substance();
          target.DeserializeJson(ref reader, options);
          break;
        case "SubstanceNucleicAcid":
          target = new Fhir.R4.Models.SubstanceNucleicAcid();
          target.DeserializeJson(ref reader, options);
          break;
        case "SubstancePolymer":
          target = new Fhir.R4.Models.SubstancePolymer();
          target.DeserializeJson(ref reader, options);
          break;
        case "SubstanceProtein":
          target = new Fhir.R4.Models.SubstanceProtein();
          target.DeserializeJson(ref reader, options);
          break;
        case "SubstanceReferenceInformation":
          target = new Fhir.R4.Models.SubstanceReferenceInformation();
          target.DeserializeJson(ref reader, options);
          break;
        case "SubstanceSourceMaterial":
          target = new Fhir.R4.Models.SubstanceSourceMaterial();
          target.DeserializeJson(ref reader, options);
          break;
        case "SubstanceSpecification":
          target = new Fhir.R4.Models.SubstanceSpecification();
          target.DeserializeJson(ref reader, options);
          break;
        case "SupplyDelivery":
          target = new Fhir.R4.Models.SupplyDelivery();
          target.DeserializeJson(ref reader, options);
          break;
        case "SupplyRequest":
          target = new Fhir.R4.Models.SupplyRequest();
          target.DeserializeJson(ref reader, options);
          break;
        case "Task":
          target = new Fhir.R4.Models.Task();
          target.DeserializeJson(ref reader, options);
          break;
        case "TerminologyCapabilities":
          target = new Fhir.R4.Models.TerminologyCapabilities();
          target.DeserializeJson(ref reader, options);
          break;
        case "TestReport":
          target = new Fhir.R4.Models.TestReport();
          target.DeserializeJson(ref reader, options);
          break;
        case "TestScript":
          target = new Fhir.R4.Models.TestScript();
          target.DeserializeJson(ref reader, options);
          break;
        case "ValueSet":
          target = new Fhir.R4.Models.ValueSet();
          target.DeserializeJson(ref reader, options);
          break;
        case "VerificationResult":
          target = new Fhir.R4.Models.VerificationResult();
          target.DeserializeJson(ref reader, options);
          break;
        case "VisionPrescription":
          target = new Fhir.R4.Models.VisionPrescription();
          target.DeserializeJson(ref reader, options);
          break;
        default:
          target = new Fhir.R4.Models.Resource();
          target.DeserializeJson(ref reader, options);
          break;
      }

      return (Resource)target;
    }
  }
}
